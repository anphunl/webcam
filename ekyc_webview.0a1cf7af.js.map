{"version":3,"sources":["facesdk.ts","node_modules/js-base64/base64.js","index.ts"],"names":[],"mappings":"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","file":"ekyc_webview.0a1cf7af.js","sourceRoot":"..","sourcesContent":["import { ninvoke } from \"q\";\n\n\ndeclare var cv: any\n\n\nconst OPENCV_URL = 'opencv.js'\n\nexport class FaceSDK {\n\n    private cap = null;\n\n    public loadOpencv = (onloadCallback) => {\n\n        let self = this\n\n        let script = document.createElement('script')\n        script.setAttribute('async', '')\n        script.setAttribute('type', 'text/javascript')\n        script.addEventListener('load', () => {\n            if (cv.getBuildInformation)\n            {\n                onloadCallback()\n            }\n            else\n            {\n                // WASM\n                cv['onRuntimeInitialized']=()=>{\n                    // console.log(cv.getBuildInformation())\n                    onloadCallback()\n                }\n            }\n        })\n        script.addEventListener('error', () => {\n        console.error('Failed to load ' + OPENCV_URL)\n        })\n        script.src = OPENCV_URL\n        let node = document.getElementsByTagName('script')[0]\n        node.parentNode.insertBefore(script, node)\n    }\n\n    public startCamera = (resolution, videoId, callback) => {\n        let self = this\n\n        const constraints = {\n            'qvga': {width: {exact: 320}, height: {exact: 240}},\n            'vga': {width: {exact: 640}, height: {exact: 480}},\n            'hd': {width: {exact: 1280}, height: {exact: 720}},\n            'fullhd': {width: {exact: 1920}, height: {exact: 1080}}}\n\n        let video = document.getElementById(videoId) as HTMLVideoElement\n        if (!video) {\n            video = document.createElement('video')\n        }\n\n        let videoConstraint = constraints[resolution]\n        if (!videoConstraint) {\n            videoConstraint = true\n        }\n\n        navigator.mediaDevices.getUserMedia({video: videoConstraint, audio: false})\n            .then(function(stream) {\n                video.srcObject = stream\n                video.play()\n                self.video = video\n                self.stream = stream\n                self.onCameraStartedCallback = callback\n                video.addEventListener('canplay', self.onVideoCanPlay, false)\n            })\n            .catch(function(err) {\n                console.error('Camera Error: ' + err.name + ' ' + err.message)\n            })✌\n    }\n\n    private onVideoCanPlay = () => {\n        if (this.onCameraStartedCallback) {\n            this.onCameraStartedCallback(this.stream, this.video)\n        }\n    }\n\n    public captureImage = () => {\n        let img = new cv.Mat(this.video.height, this.video.width, cv.CV_8UC4)\n        this.cap.read(img)\n\n        return img;\n    }\n\n    public handleVideo = () => {\n        let self = this\n        this.cap = new cv.VideoCapture(this.video)\n        \n        let src = new cv.Mat(this.video.height, this.video.width, cv.CV_8UC4)\n        let dst = new cv.Mat(this.video.height, this.video.width, cv.CV_8UC4)\n        var croptedImg = new cv.Mat()\n\n        const processFrame = async () => {\n            try {\n                // start processing.\n                self.cap.read(src)\n                src.copyTo(dst)\n\n\n                cv.imshow('canvasOutput', dst)\n                setTimeout(processFrame, 0)\n            } catch (err) {\n                console.error(err)\n            }\n        }\n\n        // schedule the first one.\n        setTimeout(processFrame, 0)\n    }\n\n    public stopCamera = () => {\n        if (this.video) {\n            this.video.pause()\n            this.video.srcObject = null\n            this.video.removeEventListener('canplay', this.onVideoCanPlay)\n        }\n        if (this.stream) {\n            this.stream.getVideoTracks()[0].stop()\n        }\n    }\n}\n","/*\n *  base64.js\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n */\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? module.exports = factory(global)\n        : typeof define === 'function' && define.amd\n        ? define(factory) : factory(global)\n}((\n    typeof self !== 'undefined' ? self\n        : typeof window !== 'undefined' ? window\n        : typeof global !== 'undefined' ? global\n: this\n), function(global) {\n    'use strict';\n    // existing version for noConflict()\n    global = global || {};\n    var _Base64 = global.Base64;\n    var version = \"2.6.4\";\n    // constants\n    var b64chars\n        = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var b64tab = function(bin) {\n        var t = {};\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\n        return t;\n    }(b64chars);\n    var fromCharCode = String.fromCharCode;\n    // encoder stuff\n    var cb_utob = function(c) {\n        if (c.length < 2) {\n            var cc = c.charCodeAt(0);\n            return cc < 0x80 ? c\n                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))\n                                + fromCharCode(0x80 | (cc & 0x3f)))\n                : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        } else {\n            var cc = 0x10000\n                + (c.charCodeAt(0) - 0xD800) * 0x400\n                + (c.charCodeAt(1) - 0xDC00);\n            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))\n                    + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        }\n    };\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n    var utob = function(u) {\n        return u.replace(re_utob, cb_utob);\n    };\n    var cb_encode = function(ccc) {\n        var padlen = [0, 2, 1][ccc.length % 3],\n        ord = ccc.charCodeAt(0) << 16\n            | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\n            | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\n        chars = [\n            b64chars.charAt( ord >>> 18),\n            b64chars.charAt((ord >>> 12) & 63),\n            padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\n            padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\n        ];\n        return chars.join('');\n    };\n    var btoa = global.btoa && typeof global.btoa == 'function'\n        ? function(b){ return global.btoa(b) } : function(b) {\n        if (b.match(/[^\\x00-\\xFF]/)) throw new RangeError(\n            'The string contains invalid characters.'\n        );\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n    var _encode = function(u) {\n        return btoa(utob(String(u)));\n    };\n    var mkUriSafe = function (b64) {\n        return b64.replace(/[+\\/]/g, function(m0) {\n            return m0 == '+' ? '-' : '_';\n        }).replace(/=/g, '');\n    };\n    var encode = function(u, urisafe) {\n        return urisafe ? mkUriSafe(_encode(u)) : _encode(u);\n    };\n    var encodeURI = function(u) { return encode(u, true) };\n    var fromUint8Array;\n    if (global.Uint8Array) fromUint8Array = function(a, urisafe) {\n        // return btoa(fromCharCode.apply(null, a));\n        var b64 = '';\n        for (var i = 0, l = a.length; i < l; i += 3) {\n            var a0 = a[i], a1 = a[i+1], a2 = a[i+2];\n            var ord = a0 << 16 | a1 << 8 | a2;\n            b64 +=    b64chars.charAt( ord >>> 18)\n                +     b64chars.charAt((ord >>> 12) & 63)\n                + ( typeof a1 != 'undefined'\n                    ? b64chars.charAt((ord >>>  6) & 63) : '=')\n                + ( typeof a2 != 'undefined'\n                    ? b64chars.charAt( ord         & 63) : '=');\n        }\n        return urisafe ? mkUriSafe(b64) : b64;\n    };\n    // decoder stuff\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\n    var cb_btou = function(cccc) {\n        switch(cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                |    ((0x3f & cccc.charCodeAt(1)) << 12)\n                |    ((0x3f & cccc.charCodeAt(2)) <<  6)\n                |     (0x3f & cccc.charCodeAt(3)),\n            offset = cp - 0x10000;\n            return (fromCharCode((offset  >>> 10) + 0xD800)\n                    + fromCharCode((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return fromCharCode(\n                ((0x0f & cccc.charCodeAt(0)) << 12)\n                    | ((0x3f & cccc.charCodeAt(1)) << 6)\n                    |  (0x3f & cccc.charCodeAt(2))\n            );\n        default:\n            return  fromCharCode(\n                ((0x1f & cccc.charCodeAt(0)) << 6)\n                    |  (0x3f & cccc.charCodeAt(1))\n            );\n        }\n    };\n    var btou = function(b) {\n        return b.replace(re_btou, cb_btou);\n    };\n    var cb_decode = function(cccc) {\n        var len = cccc.length,\n        padlen = len % 4,\n        n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\n            | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\n            | (len > 2 ? b64tab[cccc.charAt(2)] <<  6 : 0)\n            | (len > 3 ? b64tab[cccc.charAt(3)]       : 0),\n        chars = [\n            fromCharCode( n >>> 16),\n            fromCharCode((n >>>  8) & 0xff),\n            fromCharCode( n         & 0xff)\n        ];\n        chars.length -= [0, 0, 2, 1][padlen];\n        return chars.join('');\n    };\n    var _atob = global.atob && typeof global.atob == 'function'\n        ? function(a){ return global.atob(a) } : function(a){\n        return a.replace(/\\S{1,4}/g, cb_decode);\n    };\n    var atob = function(a) {\n        return _atob(String(a).replace(/[^A-Za-z0-9\\+\\/]/g, ''));\n    };\n    var _decode = function(a) { return btou(_atob(a)) };\n    var _fromURI = function(a) {\n        return String(a).replace(/[-_]/g, function(m0) {\n            return m0 == '-' ? '+' : '/'\n        }).replace(/[^A-Za-z0-9\\+\\/]/g, '');\n    };\n    var decode = function(a){\n        return _decode(_fromURI(a));\n    };\n    var toUint8Array;\n    if (global.Uint8Array) toUint8Array = function(a) {\n        return Uint8Array.from(atob(_fromURI(a)), function(c) {\n            return c.charCodeAt(0);\n        });\n    };\n    var noConflict = function() {\n        var Base64 = global.Base64;\n        global.Base64 = _Base64;\n        return Base64;\n    };\n    // export Base64\n    global.Base64 = {\n        VERSION: version,\n        atob: atob,\n        btoa: btoa,\n        fromBase64: decode,\n        toBase64: encode,\n        utob: utob,\n        encode: encode,\n        encodeURI: encodeURI,\n        btou: btou,\n        decode: decode,\n        noConflict: noConflict,\n        fromUint8Array: fromUint8Array,\n        toUint8Array: toUint8Array\n    };\n    // if ES5 is available, make Base64.extendString() available\n    if (typeof Object.defineProperty === 'function') {\n        var noEnum = function(v){\n            return {value:v,enumerable:false,writable:true,configurable:true};\n        };\n        global.Base64.extendString = function () {\n            Object.defineProperty(\n                String.prototype, 'fromBase64', noEnum(function () {\n                    return decode(this)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64', noEnum(function (urisafe) {\n                    return encode(this, urisafe)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64URI', noEnum(function () {\n                    return encode(this, true)\n                }));\n        };\n    }\n    //\n    // export Base64 to the namespace\n    //\n    if (global['Meteor']) { // Meteor.js\n        Base64 = global.Base64;\n    }\n    // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports.Base64 = global.Base64;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], function(){ return global.Base64 });\n    }\n    // that's it!\n    return {Base64: global.Base64}\n}));\n","\nimport { FaceSDK } from \"./facesdk\";\nimport {Base64} from 'js-base64'\n\n(async () => {\n\n  // init OpenCV and open webcam\n  let facesdk = new FaceSDK()\n\n  async function buttonClick() {\n    let btn = document.getElementById(\"btnCapture\")\n    btn.disabled = true\n\n    let img = facesdk.captureImage();\n\n    let response = await fetch('http://localhost:5000/api/wv_compute_matching_score_two_faces', {method: 'POST', headers: {ContentType: 'application/json'},  body: JSON.stringify({width:img.size().width, height: img.size().height, image: Base64.fromUint8Array(img.data), user_id: Math.floor(Date.now()/500) - 3205503000})});\n    let data = await response.json();\n    console.log(JSON.stringify(data));\n\n    alert(JSON.stringify(data));\n\n\n    img.delete();\n\n    btn.disabled = false\n  }\n  \n  facesdk.loadOpencv(() => {\n\n    let mask = document.getElementById(\"img_face_frame\");\n    mask.hidden = false;\n\n    let id_rect = document.getElementById(\"img_id_frame\");\n    id_rect.hidden = false;\n\n    facesdk.startCamera('hd', 'videoInput', () => {\n      let btn = document.getElementById(\"btnCapture\")\n      btn.disabled = false\n      btn.addEventListener(\"click\", (e:Event) =>  buttonClick());\n\n      facesdk.handleVideo()\n    })\n  })\n\n  \n})()\n"]}